extends layout 

block content
  
  div(style="font-size: 16px; width: 75rem; margin: auto")
    p(style="text-align: center; font-size:22px; font-weight: bold") WELCOME TO POSTS
    br
    form(action='/posts' style=" text-align: center;")
      input(type='text' placeholder='Search..' name='search')
      button.w3-blue(type='submit')
         i.fa.fa-search.w3-large.w3-text-white

    br

    each post in posts

     .w3-container
      .w3-container-card-4
        header.w3-container.w3-blue(style="border-radius: 5px 5px 0 0;")
          div(style="margin-top:10px;margin-bottom:10px;")
            a(href="/perfil/"+post.autor.emailA  style="font-weight: bold;color:white;") 
              u #{post.autor.nomeA}
            |
            |
            i.fa.fa-arrow-right 
            |
            |
            a(href="/recursos/"+post.rec.idRec  style="font-weight: bold;color:white;") #{post.rec.titRec}
            div(style="float:right;")
              if level=="admin"
                a(href="/posts/remover/"+post._id  style="font-weight: bold;color:white;text-decoration:none;")
                  i(class="w3-xlarge material-icons" ) cancel
              else if post.autor.emailA==email
                a(href="/posts/remover/"+post._id  style="font-weight: bold;color:white;text-decoration:none;")
                  i(class="w3-xlarge material-icons" ) cancel               


      .w3-container.w3-border-blue.w3-grey
        h3.w3-center(style="margin-top:10px") #{post.titulo}
        p(style="margin-top:10px") #{post.descricao}
        a(href="/recursos/"+post.rec.idRec style="float:right;font-weight: bold;margin-bottom:6px;color:white") Sobre o recurso   


      footer.w3-container.w3-grey 
        .w3-container.w3-border-bottom.w3-border-top.w3-border-black
          if post.comentarios.length>0
            .w3-btn(style="box-shadow:none;" onclick='showComents("'+post.titulo+'")') Ver Comentários
          h5(style="float: right;margin-top:10px") Escrito em: #{post.dataRegisto.split("T")[0]}

          
      
      
      div(id=post.titulo , style="display: none;font-size:14px")
       .w3-container.w3-grey
         .w3-container.w3-border-bottom.w3-border-black(style="witdh:60%")
           br
           each coment in post.comentarios                  
                
                .w3-container.w3-light-gray(style="border-radius: 25px;")
                  div(style="float:right;margin-top:5px")
                    if level=="admin"
                      a(href="/posts/remover/"+post._id+"/comentario/"+coment._id  style="font-weight: bold;color:gray;text-decoration:none;")
                        i(class="w3-large material-icons" ) cancel
                    else if coment.emailC==email
                      a(href="/posts/remover/"+post._id+"/comentario/"+coment._id   style="font-weight: bold;color:gray;text-decoration:none;")
                        i(class="w3-large material-icons" ) cancel
                  h4(style="margin-top:10px") #{coment.nomeC}
                  p #{coment.comentario}
                  h6(style="float: right") Escrito em: #{coment.dataC.split("T")[0]}, #{coment.dataC.split("T")[1].split(".")[0]}
                br
  
      .w3-container.w3-grey(style="border-radius: 0 0 5px 5px ;")
        br
        form(class="w3-container" action='/posts/comentario/'+post._id, method='POST')
            input(style="font-size:14px;margin-left:10px;width: 96%;" class="w3-input w3-border", type="text", name="comentario", placeholder="Escreve um comentário...") 
        br

      br
      br
      br
      br



    script.
       function showComents(id) {
       var x = document.getElementById(id);
       if (x.style.display === "none") {
       x.style.display = "block";
       } else {
       x.style.display = "none";
       }
       }

       function addComent(id) {
       var x = document.getElementById(id);
       if (x.style.display === "none") {
       x.style.display = "block";
       } else {
       x.style.display = "none";
       }
       }